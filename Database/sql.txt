create table name(
id int not null auto_increment,

primary key (id)
)default charset = utf8;

create table user(
id int not null auto_increment,
name varchar(50),
phone varchar(50),
password varchar(50),
image varchar(50),
primary key (id)
)DEFAULT CHARSET=utf8;

create table supplier(
id int not null auto_increment,
name varchar (50) null,
phone varchar(50) not null,
address varchar(50) null,
primary key (id)
)default charset = utf8;

create table customer(
id int not null auto_increment,
name varchar (50) null,
phone varchar(50) not null,
address varchar(50) null,
primary key (id)
)default charset = utf8;

create table repertory(
id int not null auto_increment,
goods_id int,
goods_count int,
user_id int not null,
primary key (id)
)default charset = utf8;

create table goods(
id int not null auto_increment,
name varchar(50),
unit varchar(50),
in_unit_price float,
out_unit_price float,
image varchar(50),
primary key (id)
)default charset = utf8;

create table in_bill(
id int not null auto_increment,
goods_id int,
goods_count int,
supplier_id int,
time datetime,
user_id int,
primary key (id)
)default charset = utf8;

create table out_bill(
id int not null auto_increment,
goods_id int,
goods_count int,
customer_id int,
is_paid bool default 0,
deliverer_id int,
deliver_status tinyint default -1,
time datetime,
user_id int not null,
primary key (id)
)default charset = utf8;

create table deliverer(
id int not null auto_increment,
name varchar(50),
phone varchar(50),
password varchar(50),
status tinyint default 0,
primary key (id)
)default charset = utf8;

create table user_customer(
id int not null auto_increment,
user_id int not null,
customer_id int not null,
primary key (id)
)default charset = utf8;

create table user_supplier_goods(
id int not null auto_increment,
user_id int not null,
supplier_id int not null,
goods_id int not null,
primary key (id)
)default charset = utf8;

DELIMITER $$
create procedure save_customer(
in )
begin
	
end$$
DELIMITER ;

DELIMITER $$
create procedure save_customer(
in userId int, in customerPhone varchar(50), in customerName varchar(50), in customerAddress varchar(50), out result int)
begin
	declare customerId int;
	declare resultCount int;
	set result = 0;
	select count(*) into resultCount from customer where phone = customerPhone;
	if (resultCount < 1) then
		insert into customer(name, phone, address) values(customerName, customerPhone, customerAddress);
	end if;
	select id into customerId from customer where phone = customerPhone;
	select count(*) into resultCount from user_customer where user_id = userId and customer_id = customerId;
	if (resultCount < 1) then
			insert into user_customer(user_id, customer_id) values(userId, customerId);
			set result = 1;
	end if;
end$$
DELIMITER ;




























